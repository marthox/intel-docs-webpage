---
import { client } from "@utils/contentful_utils";
import { documentToHtmlString } from "@contentful/rich-text-html-renderer";
import { getLangFromUrl } from "@i18n/utils";
import "dotenv/config";
import "@styles/richText.css";
import "@styles/ReactiveForm.css";
import ReactForm from "@components/ReactForm.jsx";

const { id } = Astro.props;
const lang = getLangFromUrl(Astro.url);
const data = await client.getEntry(id, { locale: lang });
const formId = data.fields.formId;
const formTitle = data.fields.formTitle;
const formDescription = data.fields.formDescription as any;
const embeddedForm = data.fields.embeddedForm;
const formFields = data?.fields?.formFields || ([] as any);
---

{
    embeddedForm ? (
        <Fragment set:html={embeddedForm} />
    ) : (
        <ReactForm
            formId={formId}
            formTitle={formTitle}
            formDescription={documentToHtmlString(formDescription)}
            formFields={formFields}
            lang={lang}
        />
    )
}
